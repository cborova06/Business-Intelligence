import{j as w,u as b,E as C,r as v,o,d as u,f as t,t as x,K as h,F as $,g as D,y as A,h as f,i as I,an as B,c as k,w as y,e as T,s as S,P as R}from"./frappe-ui-d69b39da.js";import{s as j,b as N,u as M,_ as Q}from"./useTeams-4d4fbe26.js";import{_ as V}from"./ListPicker-9a2927d2.js";import{_ as U}from"./Form-a11ed169.js";import"./Popover-5414f173.js";const q={class:"w-1/4 bg-gray-50 p-3 text-gray-600"},E={class:"mb-2 text-lg font-medium text-gray-800"},F={class:"flex-1 space-y-1 pb-4 text-base"},L=["onClick"],O={__name:"ManageTeamSidebar",emits:["change","delete-team"],setup(g,{emit:d}){const c=w([{label:"Members",icon:"users",current:!0},{label:"Data Sources",icon:"database"},{label:"Tables",icon:"table"},{label:"Dashboards",icon:"monitor"},{label:"Queries",icon:"file-text"},{label:"Delete Team",icon:"trash-2",variant:"solid",theme:"red"}]),p=d,l=b({get:()=>c.value.find(i=>i.current).label,set:i=>{c.value=c.value.map(a=>(a.current=a.label==i,a)),p("change",i)}}),m=C("team");function e(i){i.variant=="danger"?r():l.value=i.label}function r(){j({title:"Delete Team",message:"Are you sure you want to delete this team?",icon:{name:"trash",variant:"solid",theme:"red"},primaryAction:{label:"Delete",variant:"solid",theme:"red",action:({close:i})=>m.deleteTeam().then(i).then(()=>p("delete-team"))}})}return(i,a)=>{const s=v("FeatherIcon");return o(),u("div",q,[t("div",E,x(h(m).doc.team_name)+" Team",1),t("nav",F,[(o(!0),u($,null,D(c.value,n=>(o(),u("div",{key:n.label,class:A([n.current?"bg-gray-200/70":"text-gray-600 ",n.variant=="danger"?"text-red-600 hover:bg-gray-200/70 hover:text-red-600":"text-gray-600 hover:bg-gray-200/70 hover:text-gray-800","group flex cursor-pointer items-center rounded px-2 py-1.5 font-medium hover:bg-gray-200/70 hover:text-gray-800"]),onClick:_=>e(n)},[f(s,{name:n.icon,class:A(["mr-3 h-4 w-4 flex-shrink-0"])},null,8,["name"]),I(" "+x(n.label),1)],10,L))),128))])])}}},P={class:"flex w-full flex-col space-y-3 text-base"},z={class:"flex flex-shrink-0 flex-col space-y-2"},G={key:0,class:"flex-1 divide-y overflow-y-auto text-gray-800"},K={class:"flex items-center space-x-2"},H={class:"text-sm text-gray-600"},J={class:"flex items-center"},W={key:1,class:"flex flex-1 items-center justify-center text-gray-500"},X={key:2,class:"flex flex-1 items-center justify-center rounded border border-dashed p-4 font-light text-gray-500"},Y={__name:"ManageTeamMembers",setup(g){const d=C("team"),c=w([]),p=b(()=>{var e;return(e=d.memberOptions)==null?void 0:e.map(r=>({label:r.full_name,description:r.email,value:r.name}))}),l=w(!1);function m(e){l.value=!0,d.addMembers(e.map(r=>r.value)).then(()=>{l.value=!1}).catch(()=>{l.value=!1}),c.value=[]}return(e,r)=>{const i=v("Avatar"),a=v("Button"),s=v("LoadingIndicator");return o(),u("div",P,[t("div",z,[r[3]||(r[3]=t("div",{class:"text-lg font-medium"},"Members",-1)),f(V,{placeholder:"Add a member",modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=n=>c.value=n),options:p.value,loading:h(d).search_team_members.loading,onInputChange:r[1]||(r[1]=n=>h(d).searchMembers(n)),onApply:r[2]||(r[2]=n=>m(n))},null,8,["modelValue","options","loading"])]),h(d).members&&h(d).members.length?(o(),u("div",G,[(o(!0),u($,null,D(h(d).members,n=>(o(),u("div",{class:"flex h-12 justify-between px-1",key:n.name},[t("div",K,[f(i,{label:n.full_name,image:n.user_image},null,8,["label","image"]),t("div",null,[t("div",null,x(n.full_name),1),t("div",H,x(n.email),1)])]),t("div",J,[f(a,{icon:"x",variant:"minimal",onClick:_=>h(d).removeMember(n.name)},null,8,["onClick"])])]))),128))])):l.value?(o(),u("div",W,[f(s,{class:"h-6 w-6"})])):(o(),u("div",X," This team has no members "))])}}},Z={class:"flex w-full flex-col space-y-3 text-base"},ee={class:"flex flex-shrink-0 flex-col"},te={class:"text-lg font-medium leading-6"},se={class:"mb-4 text-sm text-gray-600"},ae={class:"flex-1 space-y-3 overflow-y-auto pl-1"},le={key:0,class:"divide-y"},ne={class:"w-[20rem] overflow-hidden text-ellipsis whitespace-nowrap"},oe={class:"flex items-center space-x-2"},re={key:1,class:"flex h-full items-center justify-center rounded border border-dashed p-4 text-sm font-light text-gray-600"},ie={__name:"ManageTeamResourceAccess",props:{resourceType:{type:String,required:!0}},setup(g){const d=g,c=b(()=>d.resourceType.replace("Insights ","")),p=b(()=>({"Insights Data Source":"All the tables from these data source will be accessible to the team.","Insights Table":"Give access to only specific tables of a data source. Tables from accessible data sources will also be accessible to the team.","Insights Query":"Queries that are accessible to this team.","Insights Dashboard":"Dashboards that are accessible to this team."})[d.resourceType]),l=C("team");l.searchResources(d.resourceType,"");const m=b(()=>{var a;return(a=l.resources)==null?void 0:a.filter(s=>s.type==d.resourceType)}),e=w([]),r=b(()=>{var a;return(a=l.resourceOptions)==null?void 0:a.map(s=>{const n={"Insights Data Source":`${s.database_type}`,"Insights Table":`${s.data_source}`,"Insights Query":`${s.data_source}`,"Insights Dashboard":""};return{...s,value:s.name,label:s.title,description:n[s.type]}})});function i(a){l.addResources(a),e.value=[]}return(a,s)=>{const n=v("Button");return o(),u("div",Z,[t("div",ee,[t("div",te,"Manage "+x(c.value)+" Access",1),t("div",se,x(p.value),1),f(V,{placeholder:`Add a ${c.value}`,modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=_=>e.value=_),options:r.value,loading:h(l).search_team_resources.loading,onApply:s[1]||(s[1]=_=>i(_)),onInputChange:s[2]||(s[2]=_=>h(l).searchResources(d.resourceType,_))},null,8,["placeholder","modelValue","options","loading"])]),t("div",ae,[m.value&&m.value.length?(o(),u("div",le,[(o(!0),u($,null,D(m.value,_=>(o(),u("div",{class:"flex h-10 items-center justify-between",key:_.name},[t("span",ne,x(_.title),1),t("div",oe,[f(n,{icon:"x",variant:"minimal",onClick:Se=>h(l).removeResource(_)},null,8,["onClick"])])]))),128))])):(o(),u("div",re," No "+x(c.value)+" added yet. ",1))])])}}},de={class:"flex h-[70vh] text-base"},ce={class:"flex w-3/4 space-y-4 overflow-y-auto p-5"},ue={__name:"ManageTeamDialog",props:{teamname:{type:String,required:!0}},emits:["close"],setup(g,{emit:d}){const c=d,p=g,l=w("Members"),m=N(p.teamname);B("team",m);const e=b({get:()=>{var r;return!!((r=m.doc)!=null&&r.team_name)},set:r=>{r||c("close")}});return(r,i)=>{var s;const a=v("Dialog");return o(),k(a,{options:{title:`Manage ${(s=h(m).doc)==null?void 0:s.team_name} Team`,size:"3xl"},modelValue:e.value,"onUpdate:modelValue":i[2]||(i[2]=n=>e.value=n)},{body:y(()=>[t("div",de,[f(O,{onChange:i[0]||(i[0]=n=>l.value=n),onDeleteTeam:i[1]||(i[1]=n=>e.value=!1)}),t("div",ce,[l.value=="Members"?(o(),k(Y,{key:0})):T("",!0),l.value!="Members"?(o(),k(ie,{key:l.value,resourceType:{"Data Sources":"Insights Data Source",Tables:"Insights Table",Queries:"Insights Query",Dashboards:"Insights Dashboard"}[l.value]},null,8,["resourceType"])):T("",!0)])])]),_:1},8,["options","modelValue"])}}},me={__name:"AddTeamDialog",emits:["close"],setup(g,{emit:d}){const c=d,p=b({get:()=>!0,set:i=>{i||c("close")}}),l=S({team_name:""}),m=M(),e=R({url:"insights.insights.doctype.insights_team.insights_team_client.add_new_team"});function r(){e.submit({team_name:l.team_name}).then(()=>{m.refresh(),c("close")})}return(i,a)=>{const s=v("Button"),n=v("Dialog");return o(),k(n,{options:{title:"Add Team"},modelValue:p.value,"onUpdate:modelValue":a[2]||(a[2]=_=>p.value=_)},{"body-content":y(()=>[f(U,{modelValue:l,"onUpdate:modelValue":a[0]||(a[0]=_=>l=_),meta:{fields:[{name:"team_name",label:"Team Name",type:"text",placeholder:"Enter team name"}]}},null,8,["modelValue"])]),actions:y(()=>[f(s,{variant:"solid",disabled:!l.team_name,onClick:r},{default:y(()=>a[3]||(a[3]=[I(" Add ")])),_:1},8,["disabled"]),f(s,{onClick:a[1]||(a[1]=_=>p.value=!1)},{default:y(()=>a[4]||(a[4]=[I("Cancel")])),_:1})]),_:1},8,["modelValue"])}}},pe={class:"flex -space-x-2"},_e={__name:"Avatars",props:{avatars:{type:Array,required:!0}},setup(g){return(d,c)=>{const p=v("Avatar");return o(),u("div",pe,[(o(!0),u($,null,D(g.avatars,l=>(o(),k(p,{class:"ring-2 ring-white",key:l.label,label:l.label,image:l.image},null,8,["label","image"]))),128))])}}},fe={class:"flex flex-1 justify-between"},he={class:"space-x-4"},xe={class:"flex flex-1 flex-col overflow-hidden"},ve={class:"mb-4 flex flex-shrink-0 space-x-4"},ge={class:"flex flex-1 flex-col rounded border"},be={class:"flex flex-shrink-0 items-center justify-between border-b px-4 py-3 text-sm text-gray-600"},ye={class:"mr-4"},ke={key:0,role:"list",class:"flex flex-1 flex-col divide-y divide-gray-200 overflow-y-auto"},we=["onClick"],$e={class:"flex h-11 cursor-pointer items-center rounded px-4 hover:bg-gray-50"},Te={class:"mr-4"},De={class:"flex-1 flex-shrink-0 overflow-hidden text-ellipsis whitespace-nowrap text-sm font-medium text-gray-900"},Ie={class:"flex-1 flex-shrink-0 overflow-hidden whitespace-nowrap text-sm text-gray-600"},Ce={key:1},Ae={class:"hidden flex-1 flex-shrink-0 overflow-hidden whitespace-nowrap text-sm text-gray-600 lg:inline-block"},Me={class:"hidden flex-1 flex-shrink-0 overflow-hidden whitespace-nowrap text-sm text-gray-600 lg:inline-block"},Ve={class:"hidden flex-1 flex-shrink-0 overflow-hidden whitespace-nowrap text-sm text-gray-600 lg:inline-block"},Be={class:"hidden flex-1 flex-shrink-0 overflow-hidden whitespace-nowrap text-sm text-gray-600 lg:inline-block"},qe={__name:"Teams",setup(g){const d=M(),c=w(null),p=w(!1);function l(m){return m.map(e=>({label:e.full_name,image:e.user_image})).slice(0,3).concat(m.length>3?[{label:`${m.length-3}`}]:[])}return(m,e)=>{const r=v("Button"),i=v("Input");return o(),u($,null,[f(Q,null,{header:y(()=>[t("div",fe,[e[4]||(e[4]=t("h1",{class:"text-3xl font-medium text-gray-900"},"Teams",-1)),t("div",he,[f(r,{variant:"outline",class:"shadow",iconLeft:"plus",onClick:e[0]||(e[0]=a=>p.value=!0)},{default:y(()=>e[3]||(e[3]=[I("Add Team")])),_:1})])])]),main:y(()=>{var a;return[t("div",xe,[t("div",ve,[f(i,{type:"text",placeholder:"Team Name"})]),t("div",ge,[t("div",be,[t("p",ye,[f(i,{type:"checkbox",class:"rounded border-gray-300"})]),e[5]||(e[5]=t("p",{class:"flex-1 flex-shrink-0"},"Team Name",-1)),e[6]||(e[6]=t("p",{class:"flex-1 flex-shrink-0"},"Members",-1)),e[7]||(e[7]=t("p",{class:"hidden flex-1 flex-shrink-0 lg:inline-block"},"Data Sources",-1)),e[8]||(e[8]=t("p",{class:"hidden flex-1 flex-shrink-0 lg:inline-block"},"Tables",-1)),e[9]||(e[9]=t("p",{class:"hidden flex-1 flex-shrink-0 lg:inline-block"},"Queries",-1)),e[10]||(e[10]=t("p",{class:"hidden flex-1 flex-shrink-0 lg:inline-block"},"Dashboards",-1))]),((a=h(d).list)==null?void 0:a.length)>0?(o(),u("ul",ke,[(o(!0),u($,null,D(h(d).list,s=>(o(),u("li",{key:s.name,onClick:n=>c.value=s.name},[t("div",$e,[t("p",Te,[f(i,{type:"checkbox",class:"rounded border-gray-300"})]),t("p",De,x(s.team_name),1),t("p",Ie,[s.members.length>0?(o(),k(_e,{key:0,avatars:l(s.members)},null,8,["avatars"])):(o(),u("span",Ce," - "))]),t("p",Ae,x(s.source_count),1),t("p",Me,x(s.table_count),1),t("p",Ve,x(s.query_count),1),t("p",Be,x(s.dashboard_count),1)])],8,we))),128))])):T("",!0)])])]}),_:1}),p.value?(o(),k(me,{key:0,onClose:e[1]||(e[1]=a=>p.value=!1)})):T("",!0),c.value?(o(),k(ue,{key:1,teamname:c.value,onClose:e[2]||(e[2]=a=>c.value=null)},null,8,["teamname"])):T("",!0)],64)}}};export{qe as default};
//# sourceMappingURL=Teams-a5db73b5.js.map
