import{s as S,j as m,v as C,aE as w,x as V,T as y,I as B,d as n,f as e,h as s,K as a,w as u,F as k,g as F,r as f,o as c,aF as T,aC as L,t as p}from"./frappe-ui-d69b39da.js";import{c as N,a as R,b as $}from"./main-d2d228fc.js";import{S as A}from"./search-34ad51bc.js";import{R as O}from"./refresh-cw-ef6c08ee.js";import{E as U}from"./eye-c3c38d1f.js";import{c as D}from"./index-77f7bd6f.js";import{C as z}from"./clock-73e01da8.js";import"./text-cursor-input-3636b908.js";import"./combine-0dbf7ac7.js";import"./chevron-down-7c5e9308.js";/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=D("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=D("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),d=m([]),x=m(!1);async function b(l,o=50){return x.value=!0,d.value=await C("insights.api.dashboards.get_dashboards",{search_term:l,limit:o}),d.value=d.value.map(i=>({...i,created_from_now:w(i.creation),modified_from_now:w(i.modified)})),x.value=!1,d.value}const _=m({});async function Q(l){return _.value[l]=!0,N("Updating preview image..."),C("insights.api.dashboards.update_dashboard_preview",{dashboard_name:l}).then(o=>{R("Preview image updated successfully");const i=d.value.find(g=>g.name===l);i&&(i.preview_image=o)}).catch($).finally(()=>{_.value[l]=!1})}function W(){return d.value.length||b(),S({dashboards:d,loading:x,fetchDashboards:b,updatePreviewImage:Q,updatingPreviewImage:_})}const q={class:"flex h-12 items-center justify-between border-b py-2.5 pl-5 pr-2"},G={class:"mb-4 flex h-full flex-col gap-3 overflow-auto px-5 py-3"},H={class:"flex gap-2 overflow-visible py-1"},J={class:"h-full w-full"},X={key:0,class:"grid grid-cols-1 gap-10 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Y=["src"],Z={key:1,class:"flex h-full w-full items-center justify-center bg-gray-50/70"},ee={class:"flex items-center justify-between gap-2"},te={class:"flex-1 min-w-0"},se={class:"flex items-start gap-1"},oe=["title"],ae={class:"mt-1.5 flex gap-2"},ie={class:"flex items-center gap-1"},re={class:"text-xs text-gray-600"},le={class:"flex items-center gap-1"},ne={class:"text-xs text-gray-600"},ce={class:"flex items-center gap-1"},de={class:"text-xs text-gray-600"},ue={class:"flex flex-shrink-0 items-center"},fe={key:1,class:"flex h-full w-full flex-col items-center justify-center text-base"},Ce=V({__name:"DashboardList",setup(l){const o=W(),i=m("");y(()=>{o.fetchDashboards(i.value)});const g=B(),I=h=>[{label:"Open Workbook",icon:"external-link",onClick:()=>g.push(`/workbook/${h.workbook}`)},{label:"Refresh Preview",icon:"refresh-cw",loading:o.updatingPreviewImage,onClick:()=>o.updatePreviewImage(h.name)}];return y(()=>{document.title="Dashboards | Insights"}),(h,r)=>{const P=f("FormControl"),v=f("Button"),E=f("router-link"),j=f("Dropdown");return c(),n(k,null,[e("header",q,[s(a(T),{items:[{label:"Dashboards",route:"/dashboards"}]}),r[1]||(r[1]=e("div",{class:"flex items-center gap-2"},null,-1))]),e("div",G,[e("div",H,[s(P,{placeholder:"Search",modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=t=>i.value=t),debounce:300},{prefix:u(()=>[s(a(A),{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"])]),e("div",J,[a(o).dashboards.length?(c(),n("div",X,[(c(!0),n(k,null,F(a(o).dashboards,t=>(c(),n("div",{key:t.name,class:"group relative flex w-full cursor-pointer flex-col gap-2 rounded bg-white"},[s(E,{to:`/dashboards/${t.name}`,class:"flex h-[150px] overflow-hidden rounded shadow transition-transform duration-200 group-hover:scale-[1.01]"},{default:u(()=>[t.preview_image?(c(),n("img",{key:0,src:t.preview_image,onerror:"this.src = ''",class:"z-10 object-cover opacity-80"},null,8,Y)):(c(),n("div",Z,[s(v,{variant:"ghost",onClick:L(pe=>a(o).updatePreviewImage(t.name),["prevent","stop"]),loading:a(o).updatingPreviewImage[t.name]},{prefix:u(()=>[s(a(O),{class:"h-3.5 w-3.5 text-gray-500"})]),default:u(()=>[r[2]||(r[2]=e("span",{class:"text-gray-500"},"Load Preview",-1))]),_:2},1032,["onClick","loading"])]))]),_:2},1032,["to"]),e("div",ee,[e("div",te,[e("div",se,[e("p",{class:"truncate text-sm",title:t.title},p(t.title),9,oe)]),e("div",ae,[e("div",ie,[s(a(U),{class:"h-3 w-3 text-gray-600","stroke-width":"1.5"}),e("span",re,p(t.views),1)]),e("div",le,[s(a(K),{class:"h-3 w-3 text-gray-600","stroke-width":"1.5"}),e("span",ne,p(t.charts),1)]),e("div",ce,[s(a(z),{class:"h-3 w-3 text-gray-600","stroke-width":"1.5"}),e("span",de,p(t.modified_from_now),1)])])]),e("div",ue,[s(j,{options:I(t)},{default:u(()=>[s(v,{variant:"ghost"},{icon:u(()=>[s(a(M),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})]),_:1})]),_:2},1032,["options"])])])]))),128))])):(c(),n("div",fe,r[3]||(r[3]=[e("div",{class:"text-xl font-medium"},"No Dashboards",-1),e("div",{class:"mt-1 text-base text-gray-600"}," Create a dashboard in your workbook to view it here. ",-1)])))])])],64)}}});export{Ce as default};
//# sourceMappingURL=DashboardList-d51eb5a4.js.map
