import{I as T,j as p,u as d,E as k,T as C,d as L,f as c,h as a,K as l,w as b,F as V,r,an as B,o as $,i as E,aJ as F}from"./frappe-ui-d69b39da.js";import{I}from"./IndicatorIcon-cba5cc16.js";import{P as N}from"./PageBreadcrumbs-2c73064a.js";import{u as R}from"./useDataSource-526c5b5a.js";import{S as j}from"./search-34ad51bc.js";import"./house-94cdb6cd.js";import"./index-77f7bd6f.js";import"./chevron-right-abc82e4c.js";import"./ellipsis-10a30b7b.js";import"./toasts-2937f9d2.js";import"./cacheStore-a53900e8.js";const q={class:"sticky top-0 z-10 flex items-center justify-between bg-white px-5 py-2.5"},z={class:"mb-4 flex h-full flex-col gap-2 overflow-auto px-4"},A={class:"flex gap-2 overflow-visible py-1"},Y={__name:"DataSource",props:{name:{type:String,required:!0}},setup(f){const h=f,u=T(),o=R(h.name);B("dataSource",o),o.fetchTables();const n=p(""),y=d(()=>{const t=o.tableList.filter(e=>!e.is_query_based);return t.length?n.value?t.filter(e=>e.label.toLowerCase().includes(n.value.toLowerCase())):t:[]}),i=p(!1),v=d(()=>[{label:"Sync Tables",icon:"refresh-cw",onClick:m},{label:"Delete",icon:"trash",onClick:()=>i.value=!0}]),w=k("$notify");function m(){o.syncTables().catch(t=>w({title:"Error Syncing Tables",variant:"error"}))}C(()=>{var t;if((t=o.doc)!=null&&t.name){const e=o.doc.title||o.doc.name;document.title=`${e} - Frappe Insights`}});const g=[{label:"Table",key:"label"},{label:"Status",key:"status",getLabel:({row:t})=>t.hidden?"Disabled":"Enabled",prefix:({row:t})=>{const e=t.hidden?"text-gray-500":"text-green-500";return a(I,{class:e},null)}}];return(t,e)=>{const _=r("FormControl"),S=r("Button"),D=r("Dropdown"),x=r("Dialog");return $(),L(V,null,[c("header",q,[a(N,{class:"h-7",items:[{label:"Data Sources",route:{path:"/data-source"}},{label:l(o).doc.title}]},null,8,["items"])]),c("div",z,[c("div",A,[a(_,{placeholder:"Search by Title",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),debounce:300},{prefix:b(()=>[a(l(j),{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"]),a(S,{variant:"outline",iconLeft:"link-2",onClick:e[1]||(e[1]=s=>l(u).push(`/data-source/${l(o).doc.name}/relationships`))},{default:b(()=>e[3]||(e[3]=[E(" Manage Relationships ")])),_:1}),a(D,{placement:"left",button:{icon:"more-horizontal",variant:"outline"},options:v.value},null,8,["options"])]),a(l(F),{columns:g,rows:y.value,"row-key":"name",options:{showTooltip:!1,getRowRoute:s=>({name:"DataSourceTable",params:{name:l(o).doc.name,table:s.name}}),emptyState:{title:"No tables.",description:"No tables to display.",button:{label:"Sync Tables",variant:"solid",onClick:m}}}},null,8,["rows","options"])]),a(x,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),dismissable:!0,options:{title:"Delete Data Source",message:"Are you sure you want to delete this data source?",icon:{name:"trash",appearance:"danger"},actions:[{label:"Delete",variant:"solid",theme:"red",onClick:async()=>{await l(o).delete(),l(u).push({name:"DataSourceList"})}}]}},null,8,["modelValue","options"])],64)}}};export{Y as default};
//# sourceMappingURL=DataSource-cbd11cb4.js.map
