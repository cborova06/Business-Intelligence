import{x as D,j as d,u as b,h as a,a2 as $,D as K,r as v,o as m,d as h,f as n,w as p,K as f,c as y,e as N,m as P,aJ as F,F as C,g as T,aC as k,ad as j,aL as z,aK as M}from"./frappe-ui-d69b39da.js";import{I as X}from"./IndicatorIcon-21535c9e.js";import{s as I}from"./main-d2d228fc.js";import{u as A}from"./users-398754d3.js";import{S as J}from"./search-34ad51bc.js";import{P as O}from"./plus-3394075c.js";import"./index-77f7bd6f.js";import"./text-cursor-input-3636b908.js";import"./combine-0dbf7ac7.js";import"./chevron-down-7c5e9308.js";const Q={class:"flex h-full w-full flex-col gap-3 overflow-x-hidden overflow-y-scroll p-8 px-10"},q={class:"flex w-full flex-1 flex-col gap-3 overflow-auto"},G={class:"flex justify-between gap-2 overflow-visible py-1"},H={class:"flex flex-col gap-4"},R={class:"flex flex-wrap gap-1 rounded bg-gray-100 p-0.5"},W={class:"min-w-[10rem] flex-1"},ue=D({__name:"UsersSettings",setup(Y){const u=A();u.getUsers();const x=d(""),U=b(()=>x.value?u.users.filter(t=>t.full_name.toLowerCase().includes(x.value.toLowerCase())||t.email.toLowerCase().includes(x.value.toLowerCase())):u.users),S=d({columns:[{label:"User",key:"full_name",prefix:t=>{const e=t.row;return a($,{size:"md",label:e.full_name,image:e.user_image},null)}},{label:"Status",key:"enabled",getLabel:t=>{const e=t.row;return e.invitation_status?e.invitation_status==="Pending"?"Invitation Sent":"Invitation Expired":t.row.enabled?"Enabled":"Disabled"},prefix:t=>{let e;const i=t.row;return i.invitation_status?e=i.invitation_status==="Pending"?"text-yellow-500":"text-red-500":e=t.row.enabled?"text-green-500":"text-gray-500",a(X,{class:e},null)}},{label:"Email",key:"email"}],rows:U,rowKey:"email",options:{selectable:!1,showTooltip:!1,emptyState:{title:"No users.",description:"No users to display.",button:I.user.is_admin?{label:"Invite User",variant:"solid",onClick:()=>c.value=!0}:void 0}}}),c=d(!1),s=d([]),l=d("");K(l,w);function w(t){const e=t.slice(-1);if(e!=" "&&e!=","){l.value=t;return}const i=t.split(/,|\s/).filter(r=>r).filter(r=>!s.value.includes(r));s.value=[...s.value,...i],l.value=""}const _=b(()=>!s.value.length&&g(l.value)?!0:s.value.length?s.value.every(t=>g(t)):!1);function g(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function E(){_.value&&(s.value.length||(s.value=[l.value]),u.inviteUsers(s.value),s.value=[],c.value=!1)}return(t,e)=>{const i=v("FormControl"),r=v("Button"),V=v("XIcon"),L=v("Dialog");return m(),h(C,null,[n("div",Q,[e[4]||(e[4]=n("h1",{class:"flex-shrink-0 text-xl font-semibold"},"Users",-1)),n("div",q,[n("div",G,[a(i,{placeholder:"Search",debounce:300},{prefix:p(()=>[a(f(J),{class:"h-4 w-4 text-gray-500"})]),_:1}),f(I).user.is_admin?(m(),y(r,{key:0,label:"Invite User",variant:"outline",onClick:e[0]||(e[0]=o=>c.value=!0)},{prefix:p(()=>[a(f(O),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})]),_:1})):N("",!0)]),a(f(F),P({class:"h-full"},S.value),null,16)])]),a(L,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),options:{title:"Invite User",size:"sm",actions:[{label:"Send Invitation",variant:"solid",disabled:!_.value,loading:f(u).sendingInvitation,onClick:E}]}},{"body-content":p(()=>[n("div",H,[n("div",R,[(m(!0),h(C,null,T(s.value,(o,B)=>(m(),y(r,{key:o,label:o,variant:"outline",class:"shadow-sm"},{suffix:p(()=>[a(V,{class:"h-4","stroke-width":"1.5",onClick:k(()=>s.value.splice(B,1),["stop"])},null,8,["onClick"])]),_:2},1032,["label"]))),128)),n("div",W,[j(n("input",{type:"text",autocomplete:"off",placeholder:"Enter email address","onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),onKeydownCapture:e[2]||(e[2]=z(k(o=>w(`${l.value} `),["stop"]),["enter"])),class:"h-7 w-full rounded border-none bg-gray-100 py-1.5 pl-2 pr-2 text-base text-gray-800 placeholder-gray-500 transition-colors focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0"},null,544),[[M,l.value]])])])])]),_:1},8,["modelValue","options"])],64)}}});export{ue as default};
//# sourceMappingURL=UsersSettings-6e2ea9d4.js.map
