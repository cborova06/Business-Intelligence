import{_ as de,r as S,o as s,d as v,h as u,x as P,M as fe,j as C,E as Q,u as M,c as V,w,f as n,K as o,t as F,g as U,F as j,e as k,i as ye,z as H,y as E,aC as z,ad as be,aK as ke,aL as ie,S as me,V as X,W as Z,aG as xe,I as we,D as $e,aH as De,aI as ce,T as Ce,an as Se,J as Ve}from"./frappe-ui-d69b39da.js";import{s as ve,f as Te,_ as Be,S as Fe,w as Ae}from"./main-d2d228fc.js";import{w as L,a as Ne,b as Ie}from"./dashboard-37329027.js";import{C as Oe}from"./ContentEditable-bc84e80c.js";import{_ as qe}from"./UserSelector.vue_vue_type_script_setup_true_lang-09c49be5.js";import{u as Me}from"./users-398754d3.js";import{B as Pe}from"./building-2-6d16ba4c.js";import{S as We,_ as ze}from"./ChartIcon.vue_vue_type_script_setup_true_lang-f01737f9.js";import{c as pe}from"./index-77f7bd6f.js";import{P as _e}from"./plus-3394075c.js";import{X as Y}from"./x-3f18ad86.js";import{C as Ee}from"./chevron-right-abc82e4c.js";import{C as je}from"./chevron-down-7c5e9308.js";import{P as Le}from"./pen-line-c3e93d95.js";import{B as Ke}from"./combine-0dbf7ac7.js";import{T as Re}from"./table-2-565c43f4.js";import{L as Ue}from"./layout-panel-top-f86bd902.js";import"./text-cursor-input-3636b908.js";import"./Autocomplete-e91e4d1c.js";import"./Popover-5414f173.js";import"./index-9194c21d.js";import"./toasts-2937f9d2.js";import"./calendar-1687c485.js";import"./clock-73e01da8.js";import"./search-34ad51bc.js";import"./chart-scatter-06f2042d.js";/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=pe("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=pe("shield-alert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),Ye={},He={class:"absolute top-0 left-0 z-50 flex h-full w-full items-center justify-center rounded bg-gray-50/30 backdrop-blur-sm"};function Ge(A,e){const p=S("LoadingIndicator");return s(),v("div",He,[u(p,{class:"h-8 w-8 text-gray-700"})])}const Xe=de(Ye,[["render",Ge]]),Ze={class:"-mb-4 flex flex-col gap-3 text-base"},et={class:"flex items-center gap-3 rounded border px-3 py-2"},tt={class:"flex flex-1 flex-col"},ot={class:"text-sm text-gray-700"},at={class:"flex w-full gap-2"},st={class:"flex-1"},nt={class:"flex flex-col gap-1 overflow-y-auto"},rt={class:"flex flex-1 flex-col"},lt={class:"leading-5"},it={class:"text-xs text-gray-600"},ct={key:0,class:"rounded border border-dashed border-gray-300 px-32 py-6 text-center text-sm text-gray-500"},ut=P({__name:"WorkbookShareDialog",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(A){const e=fe(A,"modelValue"),p=C(),d=C(),c=Me(),g=C("");function i(){g.value&&(_.value[g.value]="view",g.value="")}const _=C({}),W=x=>[{label:"Can Edit",value:"edit",onClick:()=>_.value[x]="edit"},{label:"Can View",value:"view",onClick:()=>_.value[x]="view"},{label:"Remove",value:"remove",onClick:()=>_.value[x]=void 0}],N=Q(L),B=C({});N.getSharePermissions().then(x=>{x.user_permissions.forEach(m=>{B.value[m.email]=m.access,_.value[m.email]=m.access}),p.value=x.organization_access,d.value=x.organization_access});const h=M(()=>Object.keys(_.value).map(x=>{const m=c.users.find(I=>I.email===x);return m?{email:x,full_name:m.full_name,access:_.value[x]}:null}).filter(Boolean)),$=M(()=>JSON.stringify(_.value)===JSON.stringify(B.value)&&d.value===p.value);function K(){N.updateSharePermissions({user_permissions:h.value,organization_access:d.value}),e.value=!1,Te({title:"Permissions updated",variant:"success"})}return(x,m)=>{const I=S("Dropdown"),D=S("Button"),T=S("Avatar"),J=S("Dialog");return s(),V(J,{modelValue:e.value,"onUpdate:modelValue":m[1]||(m[1]=y=>e.value=y),options:{title:"Manage Access",actions:[{label:"Save",variant:"solid",disabled:$.value,onClick:K}]}},{"body-content":w(()=>[n("div",Ze,[n("div",et,[u(o(Pe),{class:"h-6 w-6 text-blue-500","stroke-width":"1.5"}),n("div",tt,[m[2]||(m[2]=n("div",{class:"font-medium leading-5 text-gray-800"},"Organization Access",-1)),n("div",ot,F(d.value?`All users in your organization can ${d.value}`:"Only you have access to this workbook"),1)]),u(I,{options:[{label:"Disabled",onClick:()=>d.value=void 0},{label:"Can View",onClick:()=>d.value="view"},{label:"Can Edit",onClick:()=>d.value="edit"}],button:{iconRight:"chevron-down",label:d.value?`Can ${d.value}`:"Disabled"}},null,8,["options","button"])]),m[3]||(m[3]=n("hr",{class:"my-2 border-t border-gray-200"},null,-1)),n("div",at,[n("div",st,[u(qe,{modelValue:g.value,"onUpdate:modelValue":m[0]||(m[0]=y=>g.value=y),placeholder:"Search by name or email","hide-users":h.value.filter(y=>y.access).map(y=>y.email)},null,8,["modelValue","hide-users"])]),u(D,{class:"flex-shrink-0",variant:"solid",label:"Share",disabled:!g.value,onClick:i},null,8,["disabled"])]),n("div",nt,[(s(!0),v(j,null,U(h.value.filter(y=>y.access),y=>{var R;return s(),v("div",{key:y.email,class:"flex w-full items-center gap-2 py-1"},[u(T,{size:"xl",label:y.full_name,image:(R=o(c).getUser(y.email))==null?void 0:R.user_image},null,8,["label","image"]),n("div",rt,[n("div",lt,F(y.full_name),1),n("div",it,F(y.email),1)]),y.email!==o(ve).user.email?(s(),V(I,{key:0,class:"flex-shrink-0",placement:"right",options:W(y.email),button:{iconRight:"chevron-down",variant:"ghost",label:y.access==="edit"?"Can Edit":"Can View"}},null,8,["options","button"])):(s(),V(D,{key:1,variant:"ghost",label:"Owner",disabled:"",class:"flex-shrink-0"}))])}),128)),h.value.filter(y=>y.access).length===0?(s(),v("div",ct,F(d.value?`All users in your organization can ${d.value} this workbook`:"Only you have access to this workbook"),1)):k("",!0)])])]),_:1},8,["modelValue","options"])}}}),dt={key:0,class:"flex gap-2"},mt=P({__name:"WorkbookNavbarActions",setup(A){const e=Q(L),p=C(!1);return(d,c)=>{const g=S("Button"),i=S("Dropdown");return s(),v(j,null,[o(e)?(s(),v("div",dt,[o(e).canShare&&!o(e).isdirty&&!o(e).islocal?(s(),V(g,{key:0,variant:"outline",onClick:c[0]||(c[0]=_=>p.value=!0)},{prefix:w(()=>[u(o(We),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})]),default:w(()=>[c[2]||(c[2]=ye(" Share "))]),_:1})):k("",!0),u(i,{button:{icon:"more-horizontal",variant:"outline"},options:[o(e).doc.read_only?null:{label:"Duplicate",icon:"copy",onClick:()=>o(e).duplicate()},{label:"Copy JSON",icon:"copy",onClick:()=>o(e).copy()},o(e).islocal?null:{label:"Delete",icon:"trash-2",onClick:()=>o(e).delete()},o(ve).user.has_desk_access?{label:"Open in Desk",icon:"external-link",onClick:()=>o(e).openInDesk()}:null]},null,8,["options"])])):k("",!0),o(e).canShare&&p.value?(s(),V(ut,{key:1,modelValue:p.value,"onUpdate:modelValue":c[1]||(c[1]=_=>p.value=_)},null,8,["modelValue"])):k("",!0)],64)}}}),vt={class:"sticky top-0 z-10 flex h-11 w-full flex-shrink-0 items-center gap-3 bg-white px-3 shadow-sm"},pt={class:"relative flex flex-1 items-center"},_t={class:"absolute left-0"},ht={class:"flex flex-1 items-center justify-center"},gt={class:"relative flex items-center gap-3"},ft={class:"absolute right-0"},yt=P({__name:"WorkbookNavbar",setup(A){const e=Q(L);return(p,d)=>{const c=S("router-link"),g=S("Tooltip");return s(),v("div",vt,[n("div",pt,[n("div",_t,[H(p.$slots,"left",{},()=>[u(c,{to:{path:"/workbook"}},{default:w(()=>d[2]||(d[2]=[n("img",{src:Be,alt:"logo",class:"h-7 rounded"},null,-1)])),_:1})])]),n("div",ht,[n("div",gt,[o(e).doc.read_only?(s(),V(g,{key:0,text:"You have read-only access to this workbook"},{default:w(()=>[u(o(Je),{class:"absolute -left-6 h-4 w-4 cursor-pointer text-orange-600","stroke-width":"1.5"})]),_:1})):k("",!0),u(Oe,{class:"rounded-sm font-medium !text-gray-800 focus:ring-2 focus:ring-gray-700 focus:ring-offset-4",modelValue:o(e).doc.title,placeholder:"Untitled Workbook",onReturned:d[0]||(d[0]=i=>o(e).doc.title=i),onBlur:d[1]||(d[1]=i=>o(e).doc.title=i)},null,8,["modelValue"])])]),n("div",ft,[u(mt)])])])}}}),bt={class:"flex flex-col px-3.5 pt-3"},kt={class:"mb-1 flex h-6 items-center justify-between"},xt={class:"flex items-center gap-1"},wt={class:"text-sm font-medium"},$t={key:0,class:"flex h-12 flex-col items-center justify-center rounded border border-dashed border-gray-300 py-2"},Dt={class:"text-xs text-gray-500"},Ct={key:1,class:"flex flex-col border-b pb-3"},St=["onDragstart"],Vt={class:"flex gap-1.5 overflow-hidden"},Tt={class:"flex-shrink-0"},Bt={class:"truncate"},Ft=["onClick"],At=P({__name:"WorkbookSidebarListSection",props:{title:{},emptyMessage:{},items:{},itemKey:{},isActive:{type:Function},add:{type:Function},remove:{type:Function},route:{type:Function}},setup(A){const e=A;function p(d,c){if(!d.dataTransfer)return;const g=JSON.stringify({type:e.title,item:c});d.dataTransfer.setData("text/plain",g)}return(d,c)=>{const g=S("Button"),i=S("router-link");return s(),v("div",bt,[n("div",kt,[n("div",xt,[n("div",wt,F(e.title),1)]),n("div",null,[u(g,{class:"!h-fit !p-1",variant:"ghost",onClick:c[0]||(c[0]=_=>e.add())},{default:w(()=>[u(o(_e),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})]),_:1})])]),e.items.length?(s(),v("div",Ct,[(s(!0),v(j,null,U(e.items,(_,W)=>(s(),v("div",{key:_[e.itemKey],class:E(["group w-full cursor-pointer rounded transition-all hover:bg-gray-100",e.isActive(_)?" bg-gray-100":" hover:border-gray-300"]),draggable:"true",onDragstart:N=>p(N,_)},[u(i,{to:d.route(_),class:"flex h-7.5 items-center justify-between rounded pl-1.5 text-sm"},{default:w(()=>[n("div",Vt,[n("div",Tt,[H(d.$slots,"item-icon",{item:_})]),n("p",Bt,F(_.title),1)]),n("button",{class:"invisible cursor-pointer rounded px-1.5 py-1 transition-all hover:bg-gray-100 group-hover:visible",onClick:z(N=>e.remove(_),["prevent","stop"])},[u(o(Y),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})],8,Ft)]),_:2},1032,["to"])],42,St))),128))])):(s(),v("div",$t,[n("div",Dt,F(e.emptyMessage),1)]))])}}}),Nt={class:"flex flex-col px-3.5 pt-3"},It={class:"mb-1 flex h-6 items-center justify-between"},Ot={class:"flex items-center gap-1"},qt={class:"text-sm font-medium"},Mt={key:0,class:"flex gap-1"},Pt={key:0,class:"flex h-12 flex-col items-center justify-center rounded border border-dashed border-gray-300 py-2"},Wt={class:"text-xs text-gray-500"},zt={key:1,class:"flex flex-col border-b pb-3"},Et={key:0,class:"absolute -top-0.5 left-0 right-0 h-0.5 bg-blue-500 transition-all"},jt=["onDragstart","onDragover","onDrop"],Lt={class:"flex gap-1.5 overflow-hidden"},Kt={class:"flex-shrink-0"},Rt={class:"truncate"},Ut=["onClick"],Qt={key:1,class:"absolute -bottom-0.5 left-0 right-0 h-0.5 bg-blue-500 transition-all"},Jt=["onClick","onDragenter","onDrop"],Yt={class:"flex items-center gap-1.5 overflow-hidden"},Ht=["data-folder","onBlur","onKeydown"],Gt={key:3,class:"flex-1 truncate text-sm"},Xt={key:0,class:"invisible flex gap-0.5 group-hover:visible"},Zt=["onClick"],eo=["onClick"],to=["onDragenter","onDrop"],oo={key:0,class:"absolute -top-0.5 left-0 right-0 h-0.5 bg-blue-500 transition-all"},ao=["onDragstart","onDragover","onDrop"],so={class:"flex gap-1.5 overflow-hidden"},no={class:"flex-shrink-0"},ro={class:"truncate"},lo=["onClick"],io={key:1,class:"absolute -bottom-0.5 left-0 right-0 h-0.5 bg-blue-500 transition-all"},co=P({__name:"WorkbookSidebarFolders",props:{title:{},emptyMessage:{},items:{},itemKey:{},isActive:{type:Function},add:{type:Function},remove:{type:Function},route:{type:Function},type:{}},setup(A){const e=A,p=Q(L),d=M(()=>(p.doc.folders||[]).filter(t=>t.type===e.type)),c=M(()=>e.items.filter(t=>!t.folder).sort((t,r)=>t.sort_order-r.sort_order)),g=M(()=>{const t={};return e.items.forEach(r=>{r.folder&&(t[r.folder]||(t[r.folder]=[]),t[r.folder].push(r))}),Object.keys(t).forEach(r=>{t[r].sort((f,b)=>f.sort_order-b.sort_order)}),t}),i=M(()=>[...d.value].sort((t,r)=>t.sort_order-r.sort_order)),_=C(new Set);function W(t){_.value.has(t.name)?_.value.delete(t.name):_.value.add(t.name)}function N(t){return _.value.has(t)}function B(t,r){r.stopPropagation(),p.removeFolder(t.name)}const h=C(null),$=C("");C(null);function K(t,r){r.stopPropagation(),h.value=t.name,$.value=t.title,setTimeout(()=>{const f=document.querySelector(`input[data-folder="${t.name}"]`);f&&(f.focus(),f.select())},0)}function x(t){$.value&&$.value!==t.title&&(p.renameFolder(t.name,$.value),t.title=$.value),h.value=null}const m=C(null),I=C(null),D=C(null),T=C(null);function J(t,r,f){if(!t.dataTransfer)return;m.value={type:e.type,item:r,folder:f};const b=JSON.stringify(m.value);t.dataTransfer.setData("text/plain",b),t.dataTransfer.effectAllowed="move",t.currentTarget.classList.add("dragging")}function y(t){t.currentTarget.classList.remove("dragging"),m.value=null,I.value=null,D.value=null,T.value=null}function R(t,r){if(!m.value||m.value.type!==e.type||m.value.item.name===r.name)return;t.preventDefault();const b=t.currentTarget.getBoundingClientRect(),a=b.top+b.height/2;t.clientY<a?T.value="before":T.value="after",D.value=r.name}function ee(){D.value=null,T.value=null}function te(t,r,f){if(t.preventDefault(),t.stopPropagation(),!m.value||m.value.type!==e.type)return;if(m.value.item.name===r.name){D.value=null,T.value=null;return}const b=f?g.value[f]||[]:c.value,a=m.value.item.name,l=b.findIndex(q=>q.name===r.name),O=b.filter(q=>q.name!==a);let G=l;const re=b.findIndex(q=>q.name===a);re!==-1&&re<l&&G--,T.value==="after"&&G++;const le=[...O];le.splice(G,0,{name:a});const he=le.map((q,ge)=>({type:e.type,name:q.name,sort_order:ge,folder:f||null}));p.updateSortOrder(he).then(()=>{p.load()}),D.value=null,T.value=null}function oe(t,r){var f;t.stopPropagation(),((f=m.value)==null?void 0:f.type)===e.type&&(I.value=r.name)}function ae(t){const r=t.relatedTarget,f=t.currentTarget;r&&f.contains(r)||(I.value=null)}function se(t,r){if(t.preventDefault(),t.stopPropagation(),I.value=null,!m.value||m.value.type!==e.type)return;const f=r.name;if(m.value.item.folder===f)return;const b=g.value[f]||[];let a=0;b.length>0&&(a=b[b.length-1].sort_order+1);const l=[{type:e.type,name:m.value.item.name,sort_order:a,folder:f}];p.updateSortOrder(l).then(()=>{p.load()})}function ne(t){t.preventDefault()}return(t,r)=>{const f=S("Button"),b=S("router-link");return s(),v("div",Nt,[n("div",It,[n("div",Ot,[n("div",qt,F(e.title),1)]),h.value?k("",!0):(s(),v("div",Mt,[u(f,{class:"!h-fit !p-1",variant:"ghost",onClick:r[0]||(r[0]=a=>o(p).addFolder("Untitled",e.type))},{default:w(()=>[u(o(Qe),{class:"h-4 w-4 text-gray-600","stroke-width":"1.5"})]),_:1}),u(f,{class:"!h-fit !p-1",variant:"ghost",onClick:r[1]||(r[1]=a=>e.add())},{default:w(()=>[u(o(_e),{class:"h-4 w-4 text-gray-600","stroke-width":"1.5"})]),_:1})]))]),!e.items.length&&!d.value.length?(s(),v("div",Pt,[n("div",Wt,F(e.emptyMessage),1)])):(s(),v("div",zt,[(s(!0),v(j,null,U(c.value,a=>(s(),v("div",{key:a.name,class:"relative"},[D.value===a.name&&T.value==="before"?(s(),v("div",Et)):k("",!0),n("div",{class:E(["group w-full cursor-pointer rounded transition-all hover:bg-gray-100 drag-item",[e.isActive(a)?" bg-gray-100":"",D.value===a.name?"bg-blue-50":""]]),draggable:"true",onDragstart:l=>J(l,a),onDragend:y,onDragover:l=>R(l,a),onDragleave:ee,onDrop:l=>te(l,a)},[u(b,{to:t.route(a),class:"flex h-7.5 items-center justify-between rounded pl-1.5 text-sm"},{default:w(()=>[n("div",Lt,[n("div",Kt,[H(t.$slots,"item-icon",{item:a},void 0,!0)]),n("p",Rt,F(a.title),1)]),n("button",{class:"invisible cursor-pointer rounded px-1.5 py-1 transition-all hover:bg-gray-100 group-hover:visible",onClick:z(l=>e.remove(a),["prevent","stop"])},[u(o(Y),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})],8,Ut)]),_:2},1032,["to"])],42,jt),D.value===a.name&&T.value==="after"?(s(),v("div",Qt)):k("",!0)]))),128)),(s(!0),v(j,null,U(i.value,a=>(s(),v("div",{key:a.name,class:E(["mt-1 rounded transition-all",{"bg-blue-50 ring-1 ring-blue-400":I.value===a.name}])},[n("div",{class:E(["group flex h-7.5 cursor-pointer items-center justify-between rounded px-1.5 mb-0.5 transition-all hover:bg-gray-100",h.value===a.name?"ring-1 ring-gray-400":""]),onClick:l=>h.value!==a.name&&W(a),onDragenter:l=>oe(l,a),onDragleave:ae,onDrop:l=>se(l,a),onDragover:ne},[n("div",Yt,[!N(a.name)&&h.value!==a.name?(s(),V(o(Ee),{key:0,class:"h-4 w-4 flex-shrink-0 text-gray-600","stroke-width":"1.5"})):N(a.name)&&h.value!==a.name?(s(),V(o(je),{key:1,class:"h-4 w-4 flex-shrink-0 text-gray-600","stroke-width":"1.5"})):k("",!0),h.value===a.name?be((s(),v("input",{key:2,"onUpdate:modelValue":r[2]||(r[2]=l=>$.value=l),"data-folder":a.name,class:"flex-1 truncate text-sm outline-none border-none bg-transparent w-full",onClick:r[3]||(r[3]=z(()=>{},["stop"])),onBlur:l=>x(a),onKeydown:[ie(l=>x(a),["enter"]),r[4]||(r[4]=ie(l=>h.value=null,["esc"]))]},null,40,Ht)),[[ke,$.value]]):(s(),v("p",Gt,F(a.title),1))]),h.value!==a.name?(s(),v("div",Xt,[n("button",{class:"cursor-pointer rounded p-1 transition-all hover:bg-gray-200",onClick:z(l=>K(a,l),["stop"])},[u(o(Le),{class:"h-3.5 w-3.5 text-gray-700","stroke-width":"1.5"})],8,Zt),n("button",{class:"cursor-pointer rounded p-1 transition-all hover:bg-gray-200",onClick:z(l=>B(a,l),["stop"])},[u(o(Y),{class:"h-3.5 w-3.5 text-gray-700","stroke-width":"1.5"})],8,eo)])):k("",!0)],42,Jt),N(a.name)&&g.value[a.name]?(s(),v("div",{key:0,class:"ml-3 rounded",onDragenter:l=>oe(l,a),onDragleave:ae,onDrop:l=>se(l,a),onDragover:ne},[(s(!0),v(j,null,U(g.value[a.name],l=>(s(),v("div",{key:l.name,class:"relative"},[D.value===l.name&&T.value==="before"?(s(),v("div",oo)):k("",!0),n("div",{class:E(["group w-full cursor-pointer rounded transition-all hover:bg-gray-100 drag-item",[e.isActive(l)?" bg-gray-100":"",D.value===l.name?"bg-blue-50":""]]),draggable:"true",onDragstart:O=>J(O,l,a.name),onDragend:y,onDragover:O=>R(O,l),onDragleave:ee,onDrop:O=>te(O,l,a.name)},[u(b,{to:t.route(l),class:"flex h-7.5 items-center justify-between rounded pl-1.5 text-sm"},{default:w(()=>[n("div",so,[n("div",no,[H(t.$slots,"item-icon",{item:l},void 0,!0)]),n("p",ro,F(l.title),1)]),n("button",{class:"invisible cursor-pointer rounded px-1.5 py-1 transition-all hover:bg-gray-100 group-hover:visible",onClick:z(O=>e.remove(l),["prevent","stop"])},[u(o(Y),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})],8,lo)]),_:2},1032,["to"])],42,ao),D.value===l.name&&T.value==="after"?(s(),v("div",io)):k("",!0)]))),128))],40,to)):k("",!0)],2))),128))]))])}}});const ue=de(co,[["__scopeId","data-v-b11747be"]]),uo={key:0,class:"relative z-[1] flex h-full w-[17rem] flex-shrink-0 flex-col overflow-y-auto bg-white"},mo=P({__name:"WorkbookSidebar",setup(A){const e=Q(L),p=me(),d=M(()=>{var c;if(p.name==="WorkbookQuery"){const g=p.params.query_name;return(c=e.doc.queries.find(i=>i.name===g))==null?void 0:c.name}});return(c,g)=>o(e)?(s(),v("div",uo,[u(ue,X(Z({title:"Queries",emptyMessage:"No queries",items:o(e).doc.queries,itemKey:"name",type:"query",add:o(e).addQuery,remove:i=>o(e).removeQuery(i.name),isActive:i=>o(e).isActiveTab("query",i.name),route:i=>`/workbook/${o(e).name}/query/${i.name}`})),{"item-icon":w(({item:i})=>[i.is_native_query?(s(),V(o(Fe),{key:0,class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})):i.is_script_query?(s(),V(o(Ke),{key:1,class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})):(s(),V(o(Re),{key:2,class:"h-4 w-4 text-gray-700","stroke-width":"1.5"}))]),_:1},16),u(ue,X(Z({title:"Charts",emptyMessage:"No charts",items:o(e).doc.charts,itemKey:"name",type:"chart",add:()=>o(e).addChart(d.value),remove:i=>o(e).removeChart(i.name),isActive:i=>o(e).isActiveTab("chart",i.name),route:i=>`/workbook/${o(e).name}/chart/${i.name}`})),{"item-icon":w(({item:i})=>[u(ze,{"chart-type":i.chart_type},null,8,["chart-type"])]),_:1},16),u(At,X(Z({title:"Dashboards",emptyMessage:"No dashboards",items:o(e).doc.dashboards,itemKey:"name",add:o(e).addDashboard,remove:i=>o(e).removeDashboard(i.name),isActive:i=>o(e).isActiveTab("dashboard",i.name),route:i=>`/workbook/${o(e).name}/dashboard/${i.name}`})),{"item-icon":w(()=>[u(o(Ue),{class:"h-4 w-4 text-gray-700","stroke-width":"1.5"})]),_:1},16)])):k("",!0)}}),vo={class:"flex h-full w-full flex-col"};const zo=P({inheritAttrs:!1,__name:"Workbook",props:{workbook_name:{}},async setup(A){let e,p;const c=Ne(A.workbook_name);Se(L,c),window.workbook=c,[e,p]=xe(()=>Ae(()=>c.isloaded)),await e,p(),c.doc.queries.length===0&&c.addQuery();const g=we(),i=me();if(i.name==="Workbook"&&c.doc.queries.length){const B=c.doc.queries[0];g.replace(`/workbook/${c.doc.name}/query/${B.name}`)}$e(()=>({name:i.name,params:i.params}),(B,h)=>{if(B.name==="WorkbookChart"&&h.name==="WorkbookQuery"){const $=Ie(B.params.chart_name);$.doc.query===h.params.query_name&&$.refresh(!0)}});const _=De(),W=_["Meta+S"];ce(W,()=>c.save());const N=_["Meta+V"];return ce(N,()=>{navigator.clipboard&&navigator.clipboard.readText().then(B=>{try{const h=JSON.parse(B);h.type==="Query"?c.importQuery(h):h.type==="Chart"&&c.importChart(h)}catch(h){console.error(h)}})}),Ce(()=>{document.title=`${c.doc.title} | Workbook`}),(B,h)=>{const $=S("RouterView");return s(),v("div",vo,[o(c).isloaded?k("",!0):(s(),V(Xe,{key:0})),u(yt),n("div",{class:E(["relative flex w-full flex-1 overflow-hidden",o(c).showSidebar?"flex-row":"flex-col"])},[u(mo),o(c).isloaded?(s(),V($,{key:o(i).fullPath},{default:w(({Component:K})=>[(s(),V(Ve(K))),k("",!0)]),_:1})):k("",!0)],2)])}}});export{zo as default};
//# sourceMappingURL=Workbook-a9490ed9.js.map
