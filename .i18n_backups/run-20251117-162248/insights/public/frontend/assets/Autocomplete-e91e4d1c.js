import{_ as j}from"./Popover-5414f173.js";import{f as Q}from"./index-9194c21d.js";import{_ as W,aP as G,aQ as J,aR as K,aS as X,aT as Y,am as Z,r as c,o as l,c as k,w as y,h as d,z as m,f as o,d as i,t as f,e as u,y as C,ad as p,ae as g,V as z,W as L,g as A,F as I,m as B,aC as V}from"./frappe-ui-d69b39da.js";import{c as F}from"./index-77f7bd6f.js";/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=F("square-check-big",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=F("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),te={name:"Autocomplete",props:["label","modelValue","options","placeholder","bodyClasses","multiple","loading","hideSearch","autoFocus","placement","showFooter","buttonClasses"],emits:["update:modelValue","update:query","change"],components:{Popover:j,Combobox:G,ComboboxInput:J,ComboboxOptions:K,ComboboxOption:X,ComboboxButton:Y,CheckSquare:$,Square:ee},expose:["togglePopover"],data(){return{query:"",showOptions:!1}},computed:{selectedValue:{get(){var t;let e;return this.multiple?(e=(t=this.modelValue)==null?void 0:t.map(s=>{const h=this.findOption(s);return h||this.sanitizeOption(s)}),this.modelValue&&!e.length&&(e=this.sanitizeOptions(this.modelValue)),e):(e=this.findOption(this.modelValue),this.modelValue&&!e&&(e=this.sanitizeOption(this.modelValue)),e)},set(e){this.query="",e&&!this.multiple&&(this.showOptions=!1),this.$emit("update:modelValue",e)}},groups(){var t;return!this.options||this.options.length==0?[]:((t=this.options[0])!=null&&t.group?this.options:[{group:"",items:this.sanitizeOptions(this.options)}]).map((s,h)=>({key:h,group:s.group,hideLabel:s.hideLabel||!1,items:this.filterOptions(this.sanitizeOptions(s.items))})).filter(s=>s.items.length>0)},allOptions(){return this.groups.flatMap(e=>e.items)},areAllOptionsSelected(){var e;return this.multiple?this.allOptions.length===((e=this.selectedValue)==null?void 0:e.length):!1}},watch:{query(e){this.$emit("update:query",e)},showOptions(e){e&&Z(()=>{var t,s;return(s=(t=this.$refs.searchInput)==null?void 0:t.$el)==null?void 0:s.focus()})}},methods:{togglePopover(e){this.showOptions=e??!this.showOptions},findOption(e){return e&&this.allOptions.find(t=>t.value===(e.value||e))},filterOptions(e){return this.query?Q(e,{term:this.query,keys:["label","value"]}):e},displayValue(e){if(!e)return"";if(!this.multiple){if(typeof e=="object")return this.getLabel(e);let t=this.allOptions.find(s=>s.value===e);return this.getLabel(t)}return!Array.isArray(e)||e.length===0?"":e.length===1?this.getLabel(e[0]):`${e.length} selected`},getLabel(e){return typeof e!="object"?e:(e==null?void 0:e.label)||(e==null?void 0:e.value)||"No label"},sanitizeOptions(e){return e?e.map(t=>this.sanitizeOption(t)):[]},sanitizeOption(e){return typeof e=="string"?{label:e,value:e}:e},isOptionSelected(e){var t,s;return this.multiple?(s=this.selectedValue)==null?void 0:s.find(h=>h&&h.value===e.value):((t=this.selectedValue)==null?void 0:t.value)===e.value},selectAll(){this.selectedValue=this.allOptions},clearAll(){this.selectedValue=[]}}},se={class:"w-full space-y-1.5"},le={key:0,class:"block text-xs text-gray-600"},ae=["onClick"],re={class:"flex flex-1 items-center gap-2 overflow-hidden"},ie={key:0,class:"flex-1 truncate text-left text-base leading-5"},ne={key:1,class:"text-base leading-5 text-gray-600"},oe={key:0,class:"relative mb-1 w-full flex-shrink-0"},ue={class:"w-full flex-1 overflow-y-auto"},ce={key:0,class:"sticky top-0 truncate bg-white px-2.5 py-1.5 text-sm font-medium text-gray-600"},de={class:"flex flex-1 items-center gap-2 overflow-hidden"},he={key:0,class:"flex-shrink-0"},me={class:"flex-1 truncate"},fe={key:0,class:"ml-2 flex-shrink-0"},pe={key:0,class:"text-sm text-gray-600"},ge={key:1,class:"rounded-md px-2.5 py-1.5 text-base text-gray-600"},be={key:0,class:"border-t p-1"},ye={key:0,class:"flex items-center justify-end"},_e={key:1,class:"flex items-center justify-end"};function xe(e,t,s,h,_,a){const S=c("FeatherIcon"),P=c("LoadingIndicator"),N=c("ComboboxInput"),M=c("Square"),D=c("CheckSquare"),R=c("ComboboxOption"),T=c("ComboboxOptions"),w=c("Button"),U=j,E=c("Combobox");return l(),k(E,{modelValue:a.selectedValue,"onUpdate:modelValue":t[4]||(t[4]=x=>a.selectedValue=x),multiple:s.multiple,nullable:""},{default:y(({open:x})=>[d(U,{class:"w-full",show:_.showOptions,"onUpdate:show":t[3]||(t[3]=b=>_.showOptions=b),placement:s.placement},{target:y(({open:b,togglePopover:v,close:n})=>[m(e.$slots,"target",z(L({open:b,close:n,togglePopover:v,isOpen:x})),()=>[o("div",se,[e.$props.label?(l(),i("label",le,f(e.$props.label),1)):u("",!0),o("button",{class:C(["flex h-7 w-full items-center justify-between gap-2 rounded bg-gray-100 py-1 px-2 transition-colors hover:bg-gray-200 focus:ring-2 focus:ring-gray-400",[x?"bg-gray-200":"",e.$props.buttonClasses]]),onClick:()=>v()},[o("div",re,[m(e.$slots,"prefix"),a.selectedValue?(l(),i("span",ie,f(a.displayValue(a.selectedValue)),1)):(l(),i("span",ne,f(s.placeholder||""),1)),m(e.$slots,"suffix")]),p(d(S,{name:"chevron-down",class:"h-4 w-4 text-gray-600","aria-hidden":"true"},null,512),[[g,!e.$props.loading]]),p(d(P,{class:"h-4 w-4 text-gray-600"},null,512),[[g,e.$props.loading]])],10,ae)])])]),body:y(({isOpen:b,togglePopover:v})=>[p(o("div",null,[o("div",{class:C(["relative mt-1 overflow-hidden rounded-lg bg-white text-base shadow-2xl",s.bodyClasses])},[d(T,{class:"flex max-h-[15rem] flex-col overflow-hidden p-1.5",static:""},{default:y(()=>[s.hideSearch?u("",!0):(l(),i("div",oe,[d(N,{ref:"searchInput",class:"form-input w-full",type:"text",value:_.query,onChange:t[0]||(t[0]=n=>_.query=n.target.value),autocomplete:"off",placeholder:"Search"},null,8,["value"]),o("button",{class:"absolute right-0 inline-flex h-7 w-7 items-center justify-center",onClick:t[1]||(t[1]=n=>a.selectedValue=null)},[d(S,{name:"x",class:"w-4"})])])),o("div",ue,[(l(!0),i(I,null,A(a.groups,n=>p((l(),i("div",{key:n.key},[n.group&&!n.hideLabel?(l(),i("div",ce,f(n.group),1)):u("",!0),(l(!0),i(I,null,A(n.items.slice(0,50),(r,H)=>(l(),k(R,{as:"template",key:(r==null?void 0:r.value)||H,value:r},{default:y(({active:O,selected:q})=>[o("li",{class:C(["flex h-7 cursor-pointer items-center justify-between rounded px-2.5 text-base",{"bg-gray-100":O}])},[o("div",de,[e.$slots["item-prefix"]||e.$props.multiple?(l(),i("div",he,[m(e.$slots,"item-prefix",B({ref_for:!0},{active:O,selected:q,option:r}),()=>[p(d(M,{class:"h-4 w-4 text-gray-700"},null,512),[[g,!a.isOptionSelected(r)]]),p(d(D,{class:"h-4 w-4 text-gray-700"},null,512),[[g,a.isOptionSelected(r)]])])])):u("",!0),o("span",me,f(a.getLabel(r)),1)]),e.$slots["item-suffix"]||r!=null&&r.description?(l(),i("div",fe,[m(e.$slots,"item-suffix",B({ref_for:!0},{active:O,selected:q,option:r}),()=>[r!=null&&r.description?(l(),i("div",pe,f(r.description),1)):u("",!0)])])):u("",!0)],2)]),_:2},1032,["value"]))),128))])),[[g,n.items.length>0]])),128))]),a.groups.length==0?(l(),i("li",ge," No results found ")):u("",!0)]),_:3}),e.$slots.footer||s.showFooter||s.multiple?(l(),i("div",be,[m(e.$slots,"footer",z(L({togglePopover:v})),()=>[s.multiple?(l(),i("div",ye,[a.areAllOptionsSelected?u("",!0):(l(),k(w,{key:0,label:"Select All",onClick:V(a.selectAll,["stop"])},null,8,["onClick"])),a.areAllOptionsSelected?(l(),k(w,{key:1,label:"Clear All",onClick:V(a.clearAll,["stop"])},null,8,["onClick"])):u("",!0)])):(l(),i("div",_e,[d(w,{label:"Clear",onClick:t[2]||(t[2]=V(n=>a.selectedValue=null,["stop"]))})]))])])):u("",!0)],2)],512),[[g,b]])]),_:2},1032,["show","placement"])]),_:3},8,["modelValue","multiple"])}const Ce=W(te,[["render",xe]]);export{$ as S,Ce as _,ee as a};
//# sourceMappingURL=Autocomplete-e91e4d1c.js.map
