import{s as N,j as i,v as _,aE as f,x as V,I as B,u as L,aH as T,aI as $,T as E,d as I,f as u,h as t,K as m,w as b,m as z,F,r as g,a2 as M,o as P,aF as U,aJ as j}from"./frappe-ui-d69b39da.js";import{e as A,f as K,h as O}from"./main-d2d228fc.js";import{u as R}from"./users-398754d3.js";import{a as J,n as D}from"./dashboard-37329027.js";import{r as H}from"./router-9009eafe.js";import{B as Q}from"./building-2-6d16ba4c.js";import{c as v}from"./index-77f7bd6f.js";import{E as q}from"./eye-c3c38d1f.js";import{P as G}from"./plus-3394075c.js";import{S as X}from"./search-34ad51bc.js";import"./text-cursor-input-3636b908.js";import"./combine-0dbf7ac7.js";import"./chevron-down-7c5e9308.js";import"./toasts-2937f9d2.js";/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=v("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-vue-next v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=v("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),a=i([]),p=i(!1);async function h(l,n=100){return p.value=!0,a.value=await _("insights.api.workbooks.get_workbooks",{search_term:l,limit:n}),a.value=a.value.map(s=>({...s,created_from_now:f(s.creation),modified_from_now:f(s.modified)})),p.value=!1,a.value}function oo(l){A({title:"Import Workbook",message:"Are you sure you want to import this workbook?",onSuccess:()=>{_("insights.api.workbooks.import_workbook",{workbook:l}).then(n=>{h().then(()=>{K({message:"Workbook imported successfully",variant:"success"})}),H.push(`/workbook/${n}`)})}})}function eo(){return a.value.length||h(),N({workbooks:a,loading:p,getWorkbooks:h,importWorkbook:oo})}const to={class:"flex h-12 items-center justify-between border-b py-2.5 pl-5 pr-2"},ro={class:"flex items-center gap-2"},so={class:"mb-4 flex h-full flex-col gap-3 overflow-auto px-5 py-3"},ao={class:"flex gap-2 overflow-visible py-1"},yo=V({__name:"WorkbookList",setup(l){const n=B(),s=eo(),y=L(()=>s.workbooks),c=i("");O(c,()=>s.getWorkbooks(c.value),{debounce:300,immediate:!0});const k=i(!1);function d(){k.value=!0,J(D()).insert().then(o=>{n.push(`/workbook/${o.name}`)}).finally(()=>{k.value=!1})}const w=R(),x=i({columns:[{label:"Title",key:"title",width:4},{label:"Access",key:"shared_with",width:2,getLabel:e=>{const o=e.row;return o.shared_with_organization?"Everyone":o.shared_with.length===0?"Private":o.shared_with.length>1?`${o.shared_with.length} people`:w.getName(o.shared_with[0])},prefix:e=>{const o=e.row;return o.shared_with_organization?t(Q,{class:"h-3.5 w-3.5 text-blue-500"},null):o.shared_with.length===0?t(Y,{class:"h-3.5 w-3.5 text-orange-500"},null):t(Z,{class:"h-3.5 w-3.5 text-green-500"},null)}},{label:"Views",key:"views",width:1.5,getLabel:e=>{},prefix:e=>{const o=e.row;return t("div",{class:"flex gap-1"},[t(q,{class:"h-3.5 w-3.5 text-gray-600","stroke-width":"1.5"},null),t("span",{class:"font-mono text-sm text-gray-700"},[o.views])])}},{label:"Owner",key:"owner",width:2,getLabel(e){const o=e.row,r=w.getUser(o.owner);return(r==null?void 0:r.full_name)||o.owner},prefix:e=>{const o=e.row,r=w.getUser(o.owner);return t(M,{size:"md",label:o.owner,image:r==null?void 0:r.user_image},null)}},{label:"Modified",key:"modified_from_now",width:2}],rows:y,rowKey:"name",options:{showTooltip:!1,getRowRoute:e=>({path:`/workbook/${e.name}`}),emptyState:{title:"No workbooks.",description:"No workbooks to display.",button:{label:"New Workbook",variant:"solid",onClick:d,loading:k}}}}),W=T()["Meta+V"];return $(W,()=>{navigator.clipboard&&navigator.clipboard.readText().then(e=>{try{const o=JSON.parse(e);o.type==="Workbook"&&s.importWorkbook(o)}catch{}})}),E(()=>{document.title="Workbooks | Insights"}),(e,o)=>{const r=g("Button"),S=g("FormControl");return P(),I(F,null,[u("header",to,[t(m(U),{items:[{label:"Workbooks",route:"/workbook"}]}),u("div",ro,[t(r,{label:"New Workbook",variant:"solid",onClick:d,loading:k.value},{prefix:b(()=>[t(m(G),{class:"w-4"})]),_:1},8,["loading"])])]),u("div",so,[u("div",ao,[t(S,{placeholder:"Search by Title",modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=C=>c.value=C),debounce:300,autocomplete:"off"},{prefix:b(()=>[t(m(X),{class:"h-4 w-4 text-gray-500"})]),_:1},8,["modelValue"])]),t(m(j),z({class:"h-full"},x.value),null,16)])],64)}}});export{yo as default};
//# sourceMappingURL=WorkbookList-2aad0fbc.js.map
